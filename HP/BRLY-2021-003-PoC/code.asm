use64

; gST->ConOut->SetAttribute)(gST->ConOut, EFI_GREEN);
mov rax, 0x79ee018
mov rdx, 0x002
mov r8, [rax+40h]
mov rcx, r8
call qword [r8+28h]

; gST->ConOut->OutputString)(gST->ConOut, message);
mov rax, 0x79ee018
mov rdx, 0x7e9e741
mov r8, [rax+40h]
mov rcx, r8
call qword [r8+8]

; jump self
jmp short $-2
nop
nop
nop
nop
nop

; message ("Greetings from efiXplorer!")
db 0x47, 0x00, 0x72, 0x00, 0x65, 0x00, 0x65, 0x00
db 0x74, 0x00, 0x69, 0x00, 0x6e, 0x00, 0x67, 0x00
db 0x73, 0x00, 0x20, 0x00, 0x66, 0x00, 0x72, 0x00
db 0x6f, 0x00, 0x6d, 0x00, 0x20, 0x00, 0x65, 0x00
db 0x66, 0x00, 0x69, 0x00, 0x58, 0x00, 0x70, 0x00
db 0x6c, 0x00, 0x6f, 0x00, 0x72, 0x00, 0x65, 0x00
db 0x72, 0x00, 0x21, 0x00
